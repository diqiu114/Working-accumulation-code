<!--

 * @Author: ZhiQiang
 * @Date: 2022-10-30 16:12:12
 * @CodedFormat: utf8
 * @LastEditors: ZhiQiang
 * @LastEditTime: 2022-10-30 16:36:18
 * @FilePath: \蓝牙学习\蓝牙学习.md
 * @Descriptio
-->
# 蓝牙协议栈初步认识
## 协议栈结构：

![图 1](images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/IMG_20221030-161628337.png) 

## 蓝牙控制器

1. ![image-20221030164717903](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030164717903.png)

### 各个部分的作用

### 链路控制器：

1. 这个是控制空中的一些数据包进行流控重传等

1. ![image-20221030164919660](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030164919660.png)
2. ![image-20221030164933770](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030164933770.png)

## 蓝牙主机（软件实现）

### 主机框图

![image-20221030171356861](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030171356861.png)

### 组成部分

### L2CAP:逻辑链路管理与适配

![image-20221030171817281](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030171817281.png)

1. 最后一句是关键：对HCI层进行传输流控、重传等机制

### SDP服务发现

![image-20221030172203695](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030172203695.png)

1. 这里的Profile可以理解为一种规范或者服务

### SMP安全管理器

![image-20221030172447169](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030172447169.png)

1. 这个只有BLE有

### ATT属性

1. ![image-20221030172615139](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030172615139.png)
2. 先当与设备的数据库

### GATT通用属性

1. ![image-20221030172824014](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030172824014.png)
2. 为什么外围设备被称为服务器，中央设备才是客户端？

### GAP通用访问

1. ![image-20221030173227648](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030173227648.png)
2. GAP可以看成访问这些接口的一个主控

## 这些部分的脉络关系

![image-20221030173815498](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030173815498.png)

### 去除AMP的结构图

![image-20221030174633647](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030174633647.png)

# 蓝牙协议栈详细内容

## Beacon信标，是一种蓝牙广播标准（Beacon翻译意思就是信标🤣）

1. beacon并不是蓝牙技术联盟制定的标准，被称之为虚拟标准（由大的商业集团根据广泛的beacon应用提出来的）

2. ![image-20221030211931247](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030211931247.png)

3. beacon运作框图（广告和咨询的推送）

   ![image-20221030212038455](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030212038455.png)

4. 网络侧定位（定位）

   ![image-20221030212447168](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030212447168.png)

5.  定位的实际应用

![image-20221030212603789](./images/%E8%93%9D%E7%89%99%E5%AD%A6%E4%B9%A0/image-20221030212603789.png)

1. 
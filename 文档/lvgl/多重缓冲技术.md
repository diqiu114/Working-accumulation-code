名词：渲染

​	指以[软件](https://zh.wikipedia.org/wiki/软件)由[模型](https://zh.wikipedia.org/wiki/三維模型)生成[图像](https://zh.wikipedia.org/wiki/图像)的过程。模型是用语言或者数据结构进行严格定义的三维物体或虚拟场景的描述，它包括几何、视点、[纹理](https://zh.wikipedia.org/wiki/紋理)、[照明](https://zh.wikipedia.org/wiki/照明)和[阴影](https://zh.wikipedia.org/wiki/陰影)等信息。



渲染引擎：负责渲染的软件

lvgl就是一款渲染引擎



帧缓冲：**存储器的一部分，图形引擎通过更新帧缓冲，将需要显示的下一帧图像包含进来**。 帧缓冲是RAM的一个连续部分，可以根据需要设定合适的大小。 帧缓冲具有相应的宽度和高度。 因此，我们通常将帧缓冲视为存储器的一个二维部分，可通过x、y坐标检索。



屏幕怎么显示：通过读取帧缓冲中每个像素点的数据，进行显示



## 双重缓冲

### 背景

通过渲染引擎渲染数据时，若只有单帧缓冲，会产生一帧渲染完毕后，需要等待此帧显示完后才继续渲染下一帧，这会导致帧率很低，图像卡顿，由此产生双重缓冲技术。

### 原理

采用两个缓冲帧，在引擎渲染完一帧后，立即交给显示器显示，同时不等待显示器显示完成，立即开始渲染另一帧，前一帧显示完毕，若本帧已经渲染完毕，便交换这两个缓冲帧。这样做到了显示和渲染同时进行，从而减小了两帧之间的显示时间，提高了帧率。

## 三重缓冲

### 背景

在gpu进行渲染时，有一些情况，比如：某帧渲染时间大于刷新显示器时间，相邻帧渲染时间又小于刷新显示器时间，此时采用双重缓冲时，会出现帧的不连贯，从显示图像上来说，就是卡顿。这种情况就可以采用三重缓冲。

### 原理

一帧显示，两帧渲染，当一渲染帧渲染完成，就可以立即对另一缓冲帧进行渲染，而不用等待显示器显示完成。



## lvgl配合多重缓冲技术

显示屏自带屏显ram（显示内存）（这种不是真正意义的双重缓冲，只是原理有些相似）：

​	通常是对屏显ram的部分区域进行刷新，一般通过硬件传输协议进行数据传输，比如spi，这种一般用双重渲染就够了，使用方法为：两个用于渲染的缓存，采用dma+spi加速，在一区域渲染完毕后，lvlg会调用一函数，此时启动spi传输，将这段渲染好的内存都发到屏显ram中，同时mcu开始渲染下一区域，渲染结果存储到另外一个缓存中去，这种方式就让数据传输和渲染同时进行，加快了屏刷新速度。

显示屏不带屏显ram：

​	和正真的多重缓冲一致，只是没有gpu，用的是cpu进行渲染罢了

